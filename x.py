#!/usr/bin/env python
import operator
import os
import sys
import json

import rw


x = json.dumps( { "@type": "ResourceActionRequest", "id": "8fb830b0-45eb-4c5e-b00a-4e84f1fb74c7", "iconId": "machineReconfigure.png", "version": "1", "requestNumber": "51", "state": "PENDING_PRE_APPROVAL", "description": "", "reasons": "", "requestedFor": "devmgr@corp.local", "requestedBy": "devmgr@corp.local", "organization": { "tenantRef": "vsphere.local", "tenantLabel": "vsphere.local", "subtenantRef": "1a2fe95f-8e39-452a-ac95-77168705b873", "subtenantLabel": "Development" } })

x = json.dumps( { "@type": "ResourceActionRequest", "id": "8fb830b0-45eb-4c5e-b00a-4e84f1fb74c7", "iconId": "machineReconfigure.png", "version": "1", "requestNumber": "51", "state": "PENDING_PRE_APPROVAL", "description": "", "reasons": "", "requestedFor": "devmgr@corp.local", "requestedBy": "devmgr@corp.local", "organization": { "tenantRef": "vsphere.local", "tenantLabel": "vsphere.local", "subtenantRef": "1a2fe95f-8e39-452a-ac95-77168705b873", "subtenantLabel": "Development" }, "requestorEntitlementId": "6eff3893-bf07-41f5-b726-466896c54974", "preApprovalId": "7242dea9-94fa-44c7-8671-bb00c77e3c15", "postApprovalId": "", "dateCreated": "2018-07-10T06:13:56.240Z", "lastUpdated": "2018-07-10T06:13:56.940Z", "dateSubmitted": "2018-07-10T06:13:56.240Z", "dateApproved": "", "dateCompleted": "", "quote": { "leasePeriod": "", "leaseRate": "", "totalLeaseCost": "" }, "requestCompletion": "", "requestData": { "entries": [ { "key": "provider-Cafe.Shim.VirtualMachine.Reconfigure.ExecutionSelector", "value": { "type": "string", "value": "1" } }, { "key": "provider-Cafe.Shim.VirtualMachine.Reconfigure.MemorySize", "value": { "type": "integer", "value": "2048" } }, { "key": "provider-Cafe.Shim.VirtualMachine.Reconfigure.PropertyBag", "value": { "type": "string", "value": "[{\"PropertyName\":\"_number_of_instances\",\"PropertyValue\":\"1\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"Cafe.Shim.VirtualMachine.TotalStorageSize\",\"PropertyValue\":\"10\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"trace_id\",\"PropertyValue\":\"XmNhaDGC\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"VirtualMachine.Admin.AgentID\",\"PropertyValue\":\"f73e0842-0b36-eca6-06c6-7b179dc32bee\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"VirtualMachine.Admin.Hostname\",\"PropertyValue\":\"RegionA01-COMP01\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"VirtualMachine.Admin.TotalDiskUsage\",\"PropertyValue\":\"10240\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"VirtualMachine.Admin.UUID\",\"PropertyValue\":\"50083498-95b5-5299-a946-dd23cc6b3475\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"VirtualMachine.Cafe.Blueprint.Component.Cluster.Index\",\"PropertyValue\":\"0\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"VirtualMachine.Cafe.Blueprint.Component.Id\",\"PropertyValue\":\"CentOS\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"VirtualMachine.Cafe.Blueprint.Component.TypeId\",\"PropertyValue\":\"Infrastructure.CatalogItem.Machine.Virtual.vSphere\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"VirtualMachine.Cafe.Blueprint.Id\",\"PropertyValue\":\"CentOSLease\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"VirtualMachine.Cafe.Blueprint.Name\",\"PropertyValue\":\"CentOS Lease\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"VirtualMachine.CPU.Count\",\"PropertyValue\":\"1\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"VirtualMachine.Memory.Size\",\"PropertyValue\":\"1024\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"VirtualMachine.Storage.Name\",\"PropertyValue\":\"RegionA01-ISCSI01-COMP01\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"Vrm.ProxyAgent.Uri\",\"PropertyValue\":\"https:\/\/iaas-01a.corp.local\/VMPS2Proxy\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false}]" } }, { "key": "provider-MachineName", "value": { "type": "string", "value": "dev-005" } }, { "key": "provider-Cafe.Shim.VirtualMachine.Reconfigure.Networks", "value": { "type": "string", "value": "[{\"NetworkName\":\"VM-RegionA01-vDS-COMP\",\"MacAddress\":\"00:50:56:88:c7:76\",\"CustomProperties\":[{\"PropertyName\":\"AddressType\",\"PropertyValue\":\"Static\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"DnsSuffix\",\"PropertyValue\":\"corp.local\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"Gateway\",\"PropertyValue\":\"192.168.110.1\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"NetworkName\",\"PropertyValue\":\"DefaultExternalNetworkProfile\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"NetworkProfileName\",\"PropertyValue\":\"Default External Network Profile\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"PortID\",\"PropertyValue\":\"389\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"PrimaryDns\",\"PropertyValue\":\"192.168.110.10\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false},{\"PropertyName\":\"SubnetMask\",\"PropertyValue\":\"255.255.255.0\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false}]}]" } }, { "key": "provider-Cafe.Shim.VirtualMachine.Reconfigure.RequestDate", "value": { "type": "string", "value": "2018-07-10T06:13:00" } }, { "key": "provider-Cafe.Shim.VirtualMachine.Reconfigure.Storages", "value": { "type": "string", "value": "[{\"ExternalId\":\"6000C29b-a176-d43c-e176-e4249f38e3c4\",\"CapacityInGB\":10,\"StoragePath\":\"RegionA01-ISCSI01-COMP01\",\"StoragePolicy\":\"\",\"StoragePolicyMode\":\"\",\"Label\":\"Hard disk 1\",\"Device\":\"\",\"CustomProperties\":[{\"PropertyName\":\"Name\",\"PropertyValue\":\"Hard disk 1\",\"IsHidden\":false,\"IsRuntime\":false,\"IsEncrypted\":false}]}]" } }, { "key": "provider-Cafe.Shim.VirtualMachine.Reconfigure.PowerActionSelector", "value": { "type": "string", "value": "0" } }, { "key": "provider-Cafe.Shim.VirtualMachine.Reconfigure.UpdatedCpuCount", "value": "" }, { "key": "provider-machineId", "value": { "type": "string", "value": "9f9565a1-ab52-4470-85ee-ee00f3b9e465" } }, { "key": "provider-Cafe.Shim.VirtualMachine.Reconfigure.AllowForceShutdown", "value": { "type": "string", "value": "False" } }, { "key": "provider-Cafe.Shim.VirtualMachine.Reconfigure.UpdatedMemorySize", "value": { "type": "integer", "value": "2048" } }, { "key": "provider-Cafe.Shim.VirtualMachine.Reconfigure.UpdatedTotalStorageSize", "value": "" }, { "key": "provider-operationId", "value": { "type": "string", "value": "Infrastructure.Machine.Action.Reconfigure" } }, { "key": "provider-Cafe.Shim.VirtualMachine.TotalStorageSize", "value": { "type": "decimal", "value": "10.0" } }, { "key": "provider-Cafe.Shim.VirtualMachine.Reason", "value": { "type": "string", "value": "" } }, { "key": "provider-Cafe.Shim.VirtualMachine.Reconfigure.Requestor", "value": { "type": "string", "value": "devmgr@corp.local" } }, { "key": "provider-Cafe.Shim.VirtualMachine.Reconfigure.CpuCount", "value": { "type": "integer", "value": "1" } } ] }, "retriesRemaining": "3", "requestedItemName": "Reconfigure - dev-005", "requestedItemDescription": "{com.vmware.csp.component.iaas.proxy.provider@resource.action.name.desc.machine.Reconfigure}", "components": "", "stateName": "Pending Approval", "resourceRef": { "id": "aec4e7e3-1e7a-433a-9817-6aff478d20d9", "label": "dev-005" }, "resourceActionRef": { "id": "db5e2c7b-9f4b-4979-b605-c1060793d8ae", "label": "Reconfigure" }, "phase": "PENDING_PRE_APPROVAL", "executionStatus": "STARTED", "waitingStatus": "WAITING_FOR_APPROVAL", "approvalStatus": "PENDING" } )


b = json.loads(x)

e = b['requestData']['entries']

for i in e:
	if ( i['key'] == "provider-Cafe.Shim.VirtualMachine.Reconfigure.UpdatedMemorySize" ):
		print i['key'], i['value']['value']

	if ( i['key'] == "provider-Cafe.Shim.VirtualMachine.Reconfigure.UpdatedTotalStorageSize" ):
		print i['key'], i

	if ( i['key'] == "provider-Cafe.Shim.VirtualMachine.Reconfigure.UpdatedCpuCount" ):
		print i['key'], i

	if ( i['key'] == "provider-Cafe.Shim.VirtualMachine.Reconfigure.MemorySize" ):
		print i['key'], i['value']['value']



print "Requested For : ",b['requestedFor']
print "Requested By : ",b['requestedBy']
